<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Admin - Sistema de Aluguel</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <script src="js/firebase.js"></script>
</head>
<body class="bg-light">
<div class="container mt-5">
  <h3>Painel do Proprietário</h3>
  <hr>

  <h5>Cadastrar Inquilino</h5>
  <input type="text" id="cpf" class="form-control mb-2" placeholder="CPF">
  <input type="text" id="nome" class="form-control mb-2" placeholder="Nome">
  <input type="text" id="endereco" class="form-control mb-2" placeholder="Endereço">
  <input type="number" id="aluguel" class="form-control mb-2" placeholder="Valor Aluguel">
  <input type="number" id="agua" class="form-control mb-2" placeholder="Valor Água">
  <input type="password" id="senha" class="form-control mb-2" placeholder="Senha">
  <button id="btnCriar" class="btn btn-success">Cadastrar</button>

  <hr>
  <h5>Lista de Inquilinos</h5>
  <ul id="lista" class="list-group"></ul>
</div>

<script>
document.getElementById("btnCriar").addEventListener("click", async () => {
  const cpf = cpf.value.trim();
  const emailFake = `${cpf}@aluguelapp.com`;
  const senha = document.getElementById("senha").value;
  const nome = nome.value;
  const endereco = endereco.value;
  const aluguel = parseFloat(aluguel.value);
  const agua = parseFloat(agua.value);

  try {
    await auth.createUserWithEmailAndPassword(emailFake, senha);
    await db.ref("inquilinos/" + cpf).set({
      nome, endereco, aluguel, agua
    });
    alert("Inquilino cadastrado com sucesso!");
  } catch (e) {
    alert("Erro ao criar: " + e.message);
  }
});

db.ref("inquilinos").on("value", snapshot => {
  const lista = document.getElementById("lista");
  lista.innerHTML = "";
  snapshot.forEach(child => {
    const dados = child.val();
    const li = document.createElement("li");
    li.classList.add("list-group-item");
    li.textContent = `${dados.nome} - ${dados.endereco} (R$${dados.aluguel + dados.agua})`;
    lista.appendChild(li);
  });
});
</script>
</body>
</html>
